<!DOCTYPE html>
<html>
<head>
    <title>MushroomFinder</title>
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=fetch,requestAnimationFrame,Element.prototype.classList,URL"></script>
    <script src="https://openlayers.org/en/v6.5.0/build/ol.js"></script>
    <link rel="stylesheet" href="https://openlayers.org/en/v6.5.0/css/ol.css" type="text/css">
</head>
<body>
<div id="map" class="map" style= "width: 512px; height: 512px" ></div>
<script>
    var map = new ol.Map({
        target: 'map',
        layers: [
            new ol.layer.Tile({
                source: new ol.source.OSM()
            }),
            new ol.layer.Vector({
                source: new ol.source.Vector()
            })
        ],
        view: new ol.View({
            center: ol.proj.fromLonLat([37.41, 8.82]),
            zoom: 4
        })
    });

    fetch("/markers")
        .then(response => response.json())
        .then(markers => {
            var vectorSource = new ol.source.Vector(); // Create a vector source
            for (var i = 0; i < markers.length; i++) {
                var marker = markers[i];
                var lonLat = [marker.longitude, marker.latitude];
                var point = new ol.geom.Point(ol.proj.fromLonLat(lonLat)); // Create a point feature
                var feature = new ol.Feature({
                    geometry: point
                });
                vectorSource.addFeature(feature); // Add the feature to the vector source
            }
            var vectorLayer = new ol.layer.Vector({
                source: vectorSource
            });
            map.addLayer(vectorLayer); // Add the vector layer to the map
        });
</script>
</body>
</html>